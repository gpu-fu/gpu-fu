!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.beta=n():e.beta=n()}("undefined"!=typeof self?self:this,(()=>(()=>{"use strict";var e={};(e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e);var n=function(e,n,t,r){return new(t||(t=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,u)}c((r=r.apply(e,n||[])).next())}))},t=function(e,n){var t,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(e,a)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};function r(e){return void 0===e&&(e="high-performance"),n(this,void 0,void 0,(function(){var n;return t(this,(function(t){switch(t.label){case 0:if(!navigator.gpu)throw new Error("Your browser doesn't have WebGPU enabled!");return[4,navigator.gpu.requestAdapter({powerPreference:e})];case 1:if(!(n=t.sent()))throw new Error("Failed to get the GPU adapter!");return[2,n.requestDevice()]}}))}))}function o(e,r){return n(this,void 0,void 0,(function(){var n,o;return t(this,(function(t){if(!(n=document.querySelector(e)))throw new Error("The main canvas wasn't found in the HTML!");if(!(o=n.getContext("webgpu")))throw new Error("Failed to get a WebGPU canvas context!");return o.configure({device:r,format:i(),alphaMode:"opaque"}),[2,o]}))}))}function i(){var e,n,t=null===(n=null===(e=navigator.gpu)||void 0===e?void 0:e.getPreferredCanvasFormat)||void 0===n?void 0:n.bind(navigator.gpu);return t?t():"rgba8unorm"}const a=function(){function e(e){this._renders=[],this._canvasContext=e}return e.prototype.addRender=function(e){this._renders.includes(e)||this._renders.push(e)},e.prototype.outputFrame=function(e,n){var t=this._canvasContext.getCurrentTexture();this._renders.forEach((function(r){r.renderFrame(e,n,t)}))},e}();!function(e){n(this,void 0,void 0,(function(){function n(){(function(e,n,t){var r=e.createCommandEncoder();t({device:e,commandEncoder:r},n),e.queue.submit([r.finish()])})(i,c+=1,u),requestAnimationFrame(n)}var i,a,u,c;return t(this,(function(t){switch(t.label){case 0:return[4,r()];case 1:return[4,o("canvas.main",i=t.sent())];case 2:return a=t.sent(),[4,e(0,a)];case 3:return u=t.sent(),c=0,requestAnimationFrame(n),[2]}}))})).catch((function(e){document.querySelector("body").innerHTML=e,console.error(e)}))}((function(e,n){return t=void 0,r=void 0,i=function(){var e,t;return function(e,n){var t,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(e,a)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}(this,(function(r){return e=new u,(t=new a(n)).addRender(e),[2,function(e,n){t.outputFrame(e,n)}]}))},new((o=void 0)||(o=Promise))((function(e,n){function a(e){try{c(i.next(e))}catch(e){n(e)}}function u(e){try{c(i.throw(e))}catch(e){n(e)}}function c(n){var t;n.done?e(n.value):(t=n.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,u)}c((i=i.apply(t,r||[])).next())}));var t,r,o,i}));var u=function(){function e(){}return e.prototype.getRenderPipeline=function(e){return this._renderPipeline?this._renderPipeline:this._renderPipeline=e.device.createRenderPipeline({vertex:{module:e.device.createShaderModule({code:"@stage(vertex)\nfn main(\n  @builtin(vertex_index) index: u32\n) ->\n  @builtin(position) vec4<f32>\n{\n  let triangle = array<vec2<f32>, 3>(\n    vec2<f32>(0.0, 0.433),\n    vec2<f32>(-0.5, -0.433),\n    vec2<f32>(0.5, -0.433),\n  );\n\n  return vec4<f32>(triangle[index], 0.0, 1.0);\n}\n"}),entryPoint:"main"},fragment:{module:e.device.createShaderModule({code:"@stage(fragment)\nfn main(\n  @builtin(position) pos_in: vec4<f32>\n) ->\n  @location(0) vec4<f32>\n{\n  return vec4<f32>(\n    pos_in.x * 0.003,\n    pos_in.y * 0.003,\n    1.0 - (pos_in.y * 0.003),\n    1.0,\n  );\n}\n"}),entryPoint:"main",targets:[{format:"rgba8unorm"}]},primitive:{topology:"triangle-list"},layout:void 0})},e.prototype.renderFrame=function(e,n,t){var r=e.commandEncoder.beginRenderPass({colorAttachments:[{view:t.createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]});r.setPipeline(this.getRenderPipeline(e)),r.draw(3,1,0,0),r.end()},e}();return e})()));
//# sourceMappingURL=Demo1.js.map